# Generated by Django 6.0 on 2025-12-25 16:43

import django.core.validators
import django.db.models.deletion
from decimal import Decimal
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
    ]

    operations = [
        migrations.CreateModel(
            name='Expedition',
            fields=[
                ('numexp', models.AutoField(primary_key=True, serialize=False, verbose_name="Numéro d'expédition")),
                ('poids', models.DecimalField(decimal_places=2, help_text='Poids du colis en kilogrammes', max_digits=10, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Poids (kg)')),
                ('volume', models.DecimalField(decimal_places=2, help_text='Volume du colis en mètres cubes', max_digits=10, validators=[django.core.validators.MinValueValidator(Decimal('0.01'))], verbose_name='Volume (m³)')),
                ('statut', models.CharField(choices=[('EN_ATTENTE', 'En attente'), ('EN_PREPARATION', 'En préparation'), ('EN_TRANSIT', 'En transit'), ('EN_CENTRE_TRI', 'En centre de tri'), ('EN_COURS_LIVRAISON', 'En cours de livraison'), ('LIVRE', 'Livré'), ('ECHEC_LIVRAISON', 'Échec de livraison'), ('RETOUR', "Retourné à l'expéditeur")], default='EN_ATTENTE', max_length=20, verbose_name='Statut')),
                ('code_client', models.IntegerField(blank=True, help_text='Référence au client (FK vers table CLIENT)', null=True, verbose_name='Code Client')),
                ('date_creation', models.DateTimeField(auto_now_add=True, verbose_name='Date de création')),
                ('date_modification', models.DateTimeField(auto_now=True, verbose_name='Dernière modification')),
                ('description', models.TextField(blank=True, help_text='Description détaillée du contenu', null=True, verbose_name='Description du colis')),
                ('montant_estime', models.DecimalField(blank=True, decimal_places=2, help_text='Montant calculé automatiquement', max_digits=10, null=True, verbose_name='Montant estimé (DA)')),
            ],
            options={
                'verbose_name': 'Expédition',
                'verbose_name_plural': 'Expéditions',
                'db_table': 'expedition',
                'ordering': ['-date_creation'],
                'indexes': [models.Index(fields=['statut'], name='expedition_statut_37e51c_idx'), models.Index(fields=['code_client'], name='expedition_code_cl_36b8f4_idx'), models.Index(fields=['date_creation'], name='expedition_date_cr_c84285_idx')],
            },
        ),
        migrations.CreateModel(
            name='Incident',
            fields=[
                ('code_inc', models.AutoField(primary_key=True, serialize=False, verbose_name='Code incident')),
                ('type', models.CharField(choices=[('RETARD', 'Retard de livraison'), ('PERTE', 'Colis perdu'), ('ENDOMMAGEMENT', 'Colis endommagé'), ('PROBLEME_TECHNIQUE', 'Problème technique'), ('ADRESSE_INCORRECTE', 'Adresse incorrecte'), ('DESTINATAIRE_ABSENT', 'Destinataire absent'), ('REFUS_RECEPTION', 'Refus de réception'), ('ACCIDENT', 'Accident'), ('AUTRE', 'Autre')], max_length=30, verbose_name="Type d'incident")),
                ('commentaire', models.TextField(help_text="Description détaillée de l'incident", verbose_name='Commentaire')),
                ('piece_jointe', models.FileField(blank=True, help_text='Photo ou document justificatif', null=True, upload_to='incidents/%Y/%m/%d/', verbose_name='Pièce jointe')),
                ('etat', models.CharField(choices=[('OUVERT', 'Ouvert'), ('EN_COURS', 'En cours de traitement'), ('RESOLU', 'Résolu'), ('FERME', 'Fermé'), ('ANNULE', 'Annulé')], default='OUVERT', max_length=20, verbose_name='État')),
                ('resolution', models.TextField(blank=True, help_text='Description de la solution apportée', null=True, verbose_name='Résolution')),
                ('date_creation', models.DateTimeField(auto_now_add=True, verbose_name='Date de signalement')),
                ('date_resolution', models.DateTimeField(blank=True, null=True, verbose_name='Date de résolution')),
                ('numexp', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='incidents', to='expeditions.expedition', verbose_name='Expédition concernée')),
            ],
            options={
                'verbose_name': 'Incident',
                'verbose_name_plural': 'Incidents',
                'db_table': 'incident',
                'ordering': ['-date_creation'],
                'indexes': [models.Index(fields=['type'], name='incident_type_2f961b_idx'), models.Index(fields=['etat'], name='incident_etat_9e38ad_idx'), models.Index(fields=['numexp'], name='incident_numexp__f78483_idx')],
            },
        ),
    ]
